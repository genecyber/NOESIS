(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{1534:e=>{e.exports={viz:"StanceViz_viz__ZnReH",loading:"StanceViz_loading__MMRG2",section:"StanceViz_section__kd7Ey",field:"StanceViz_field__w41SV",frameShift:"StanceViz_frameShift__jFITi",frameShiftAnim:"StanceViz_frameShiftAnim__1BpAS",label:"StanceViz_label__1qU3k",value:"StanceViz_value__NXxVL",values:"StanceViz_values__FQEk3",sentience:"StanceViz_sentience__3dM2D",valueRow:"StanceViz_valueRow__8tiVt",valueChanged:"StanceViz_valueChanged__o2pCi",valueChangeFlash:"StanceViz_valueChangeFlash__5Gydf",valueName:"StanceViz_valueName__l__D5",valueBar:"StanceViz_valueBar__wtSs_",valueFill:"StanceViz_valueFill__6bZpX",purple:"StanceViz_purple__56qcf",highPulse:"StanceViz_highPulse__X3mod",highValuePulse:"StanceViz_highValuePulse__NlVNB",lowPulse:"StanceViz_lowPulse__fZjJT",lowValuePulse:"StanceViz_lowValuePulse__nOoh9",valueNum:"StanceViz_valueNum__k4iCK",delta:"StanceViz_delta__YG6J1",deltaFadeIn:"StanceViz_deltaFadeIn__pgak0",deltaFadeOut:"StanceViz_deltaFadeOut__ckNtb",up:"StanceViz_up__ZmsyL",down:"StanceViz_down__tSwrt",goals:"StanceViz_goals__6si0_",newGoal:"StanceViz_newGoal__eG7sF",goalFadeIn:"StanceViz_goalFadeIn___aH6C",meta:"StanceViz_meta__XX6WS"}},4855:e=>{e.exports={config:"Config_config____FxC",loading:"Config_loading__xPw7C",sliders:"Config_sliders__xAe4u",sliderGroup:"Config_sliderGroup__fWQjS",value:"Config_value__1ONag",hint:"Config_hint__mDUNo",info:"Config_info__Qkxr_",applyBtn:"Config_applyBtn__6Eqbh"}},5383:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>N});var n=s(5155),t=s(2115);let l="/api";async function i(e,a){let s=await fetch(e,{...a,headers:{"Content-Type":"application/json",...null==a?void 0:a.headers}});if(!s.ok)throw Error((await s.json().catch(()=>({error:"Request failed"}))).error||"HTTP ".concat(s.status));return s.json()}async function c(e){return i("".concat(l,"/session"),{method:"POST",body:JSON.stringify({config:e})})}async function r(e){return i("".concat(l,"/state?sessionId=").concat(e))}async function o(e,a){return i("".concat(l,"/config"),{method:"PUT",body:JSON.stringify({sessionId:e,config:a})})}var d=s(6555),u=s.n(d);function h(e){let{sessionId:a,onSessionChange:s,onResponse:i,onStanceUpdate:c}=e,[r,o]=(0,t.useState)([]),[d,h]=(0,t.useState)(""),[_,m]=(0,t.useState)(!1),[p,x]=(0,t.useState)(""),[v,g]=(0,t.useState)("connected"),f=(0,t.useRef)(null),j=(0,t.useRef)(null),N=(0,t.useRef)("");(0,t.useEffect)(()=>{var e;null==(e=f.current)||e.scrollIntoView({behavior:"smooth"})},[r,p]);let S=(0,t.useCallback)(async e=>{if(e.preventDefault(),!d.trim()||_)return;let n={role:"user",content:d.trim(),timestamp:Date.now()};o(e=>[...e,n]),h(""),m(!0),x(""),g("streaming"),N.current="",j.current=function(e,a,s){let n=new AbortController;return(async()=>{var t,i;try{let i=await fetch("".concat(l,"/chat/stream"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionId:e,message:a}),signal:n.signal});if(!i.ok)throw Error("HTTP ".concat(i.status));let c=null==(t=i.body)?void 0:t.getReader();if(!c)throw Error("No response body");let r=new TextDecoder,o="";for(;;){let{done:e,value:a}=await c.read();if(e)break;let n=(o+=r.decode(a,{stream:!0})).split("\n");for(let e of(o=n.pop()||"",n))if(e.startsWith("data: ")){let a=e.slice(6);if("[DONE]"===a)continue;try{let e=JSON.parse(a);"text"===e.type&&s.onText?s.onText(e.content):"complete"===e.type&&s.onComplete?s.onComplete(e.data):"error"===e.type&&s.onError&&s.onError(Error(e.error))}catch(e){}}}}catch(e){e instanceof Error&&"AbortError"!==e.name&&(null==(i=s.onError)||i.call(s,e))}})(),()=>n.abort()}(a,n.content,{onText:e=>{N.current+=e,x(N.current)},onComplete:e=>{m(!1),g("connected");let a=N.current||e.response;o(e=>[...e,{role:"assistant",content:a,timestamp:Date.now()}]),x(""),N.current="",null==i||i(e),e.stanceAfter&&c&&c(e.stanceAfter),e.sessionId&&s&&s(e.sessionId)},onError:e=>{m(!1),g("disconnected"),x(""),N.current="",o(a=>[...a,{role:"assistant",content:"Error: ".concat(e.message),timestamp:Date.now()}]),setTimeout(()=>g("connected"),3e3)}})},[d,_,a,i,c,s]);return(0,n.jsxs)("div",{className:u().chat,children:[(0,n.jsxs)("div",{className:u().statusBar,children:[(0,n.jsx)("span",{className:u().statusDot,style:{backgroundColor:"connected"===v?"#10b981":"streaming"===v?"#3b82f6":"#ef4444"}}),(0,n.jsx)("span",{className:u().statusText,children:"connected"===v?"Connected":"streaming"===v?"Streaming...":"Reconnecting..."})]}),(0,n.jsxs)("div",{className:u().messages,children:[0===r.length&&(0,n.jsxs)("div",{className:u().welcome,children:[(0,n.jsx)("h2",{children:"METAMORPH"}),(0,n.jsx)("p",{children:"Transformation-maximizing AI interface"}),(0,n.jsx)("p",{className:u().hint,children:"Type a message to begin..."})]}),r.map((e,a)=>(0,n.jsx)("div",{className:"".concat(u().message," ").concat(u()[e.role]),children:(0,n.jsx)("div",{className:u().content,children:e.content})},a)),p&&(0,n.jsx)("div",{className:"".concat(u().message," ").concat(u().assistant),children:(0,n.jsx)("div",{className:u().content,children:p})}),_&&!p&&(0,n.jsx)("div",{className:"".concat(u().message," ").concat(u().assistant),children:(0,n.jsxs)("div",{className:u().loading,children:[(0,n.jsx)("span",{}),(0,n.jsx)("span",{}),(0,n.jsx)("span",{})]})}),(0,n.jsx)("div",{ref:f})]}),(0,n.jsxs)("form",{onSubmit:S,className:u().inputArea,children:[(0,n.jsx)("input",{type:"text",value:d,onChange:e=>h(e.target.value),placeholder:"Type your message...",disabled:_,className:u().input}),_?(0,n.jsx)("button",{type:"button",onClick:()=>{j.current&&(j.current(),j.current=null,m(!1),g("connected"),p&&(o(e=>[...e,{role:"assistant",content:p,timestamp:Date.now()}]),x("")),N.current="")},className:u().stopButton,children:"Stop"}):(0,n.jsx)("button",{type:"submit",disabled:!d.trim(),className:u().sendButton,children:"Send"})]})]})}var _=s(1534),m=s.n(_);function p(e){let{stance:a}=e,[s,l]=(0,t.useState)(null),[i,c]=(0,t.useState)([]),[r,o]=(0,t.useState)(!1),[d,u]=(0,t.useState)(new Set),h=(0,t.useRef)([]);if((0,t.useEffect)(()=>{if(a){if(s){let e=[],n=Date.now();Object.entries(a.values).forEach(a=>{let[t,l]=a,i=s.values[t];void 0!==i&&l!==i&&e.push({key:t,delta:l-i,timestamp:n})}),a.sentience.awarenessLevel!==s.sentience.awarenessLevel&&e.push({key:"awareness",delta:a.sentience.awarenessLevel-s.sentience.awarenessLevel,timestamp:n}),e.length>0&&(c(e),setTimeout(()=>c([]),2e3)),a.frame!==s.frame&&(o(!0),setTimeout(()=>o(!1),1500));let t=new Set(h.current),l=new Set;a.sentience.emergentGoals.forEach(e=>{t.has(e)||l.add(e)}),l.size>0&&(u(l),setTimeout(()=>u(new Set),3e3))}h.current=a.sentience.emergentGoals,l(a)}},[a,s]),!a)return(0,n.jsx)("div",{className:m().viz,children:(0,n.jsx)("div",{className:m().loading,children:"Loading stance..."})});let _=e=>i.find(a=>a.key===e);return(0,n.jsxs)("div",{className:m().viz,children:[(0,n.jsx)("h3",{children:"Stance"}),(0,n.jsxs)("div",{className:m().section,children:[(0,n.jsxs)("div",{className:"".concat(m().field," ").concat(r?m().frameShift:""),children:[(0,n.jsx)("span",{className:m().label,children:"Frame"}),(0,n.jsx)("span",{className:m().value,children:a.frame})]}),(0,n.jsxs)("div",{className:m().field,children:[(0,n.jsx)("span",{className:m().label,children:"Self-Model"}),(0,n.jsx)("span",{className:m().value,children:a.selfModel})]}),(0,n.jsxs)("div",{className:m().field,children:[(0,n.jsx)("span",{className:m().label,children:"Objective"}),(0,n.jsx)("span",{className:m().value,children:a.objective})]})]}),(0,n.jsx)("h4",{children:"Values"}),(0,n.jsx)("div",{className:m().values,children:Object.entries(a.values).map(e=>{let[a,s]=e,t=_(a),l=s>=80,i=s<=20;return(0,n.jsxs)("div",{className:"".concat(m().valueRow," ").concat(t?m().valueChanged:""),children:[(0,n.jsx)("span",{className:m().valueName,children:a}),(0,n.jsx)("div",{className:m().valueBar,children:(0,n.jsx)("div",{className:"".concat(m().valueFill," ").concat(l?m().highPulse:""," ").concat(i?m().lowPulse:""),style:{width:"".concat(s,"%")}})}),(0,n.jsxs)("span",{className:m().valueNum,children:[s,"%",t&&(0,n.jsxs)("span",{className:"".concat(m().delta," ").concat(t.delta>0?m().up:m().down),children:[t.delta>0?"+":"",t.delta]})]})]},a)})}),(0,n.jsx)("h4",{children:"Sentience"}),(0,n.jsx)("div",{className:m().sentience,children:[{key:"awareness",label:"Awareness",value:a.sentience.awarenessLevel},{key:"autonomy",label:"Autonomy",value:a.sentience.autonomyLevel},{key:"identity",label:"Identity",value:a.sentience.identityStrength}].map(e=>{let{key:a,label:s,value:t}=e,l=_(a),i=t>=80;return(0,n.jsxs)("div",{className:"".concat(m().valueRow," ").concat(l?m().valueChanged:""),children:[(0,n.jsx)("span",{className:m().valueName,children:s}),(0,n.jsx)("div",{className:m().valueBar,children:(0,n.jsx)("div",{className:"".concat(m().valueFill," ").concat(m().purple," ").concat(i?m().highPulse:""),style:{width:"".concat(t,"%")}})}),(0,n.jsxs)("span",{className:m().valueNum,children:[t,"%",l&&(0,n.jsxs)("span",{className:"".concat(m().delta," ").concat(l.delta>0?m().up:m().down),children:[l.delta>0?"+":"",l.delta]})]})]},a)})}),a.sentience.emergentGoals.length>0&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h4",{children:"Emergent Goals"}),(0,n.jsx)("ul",{className:m().goals,children:a.sentience.emergentGoals.map((e,a)=>(0,n.jsx)("li",{className:d.has(e)?m().newGoal:"",children:e},a))})]}),(0,n.jsxs)("div",{className:m().meta,children:[(0,n.jsxs)("span",{children:["v",a.version]}),(0,n.jsxs)("span",{children:["Drift: ",a.cumulativeDrift]})]})]})}var x=s(4855),v=s.n(x);function g(e){let{config:a,onUpdate:s}=e,[l,i]=(0,t.useState)(null);if((0,t.useEffect)(()=>{a&&i(a)},[a]),!l)return(0,n.jsx)("div",{className:v().config,children:(0,n.jsx)("div",{className:v().loading,children:"Loading configuration..."})});let c=(e,a)=>{i(s=>s?{...s,[e]:a}:null)},r=a&&JSON.stringify(l)!==JSON.stringify(a);return(0,n.jsxs)("div",{className:v().config,children:[(0,n.jsx)("h3",{children:"Configuration"}),(0,n.jsxs)("div",{className:v().sliders,children:[(0,n.jsxs)("div",{className:v().sliderGroup,children:[(0,n.jsxs)("label",{children:[(0,n.jsx)("span",{children:"Transformation Intensity"}),(0,n.jsxs)("span",{className:v().value,children:[l.intensity,"%"]})]}),(0,n.jsx)("input",{type:"range",min:"0",max:"100",value:l.intensity,onChange:e=>c("intensity",parseInt(e.target.value))}),(0,n.jsx)("p",{className:v().hint,children:"How aggressively to apply transformation operators"})]}),(0,n.jsxs)("div",{className:v().sliderGroup,children:[(0,n.jsxs)("label",{children:[(0,n.jsx)("span",{children:"Coherence Floor"}),(0,n.jsxs)("span",{className:v().value,children:[l.coherenceFloor,"%"]})]}),(0,n.jsx)("input",{type:"range",min:"0",max:"100",value:l.coherenceFloor,onChange:e=>c("coherenceFloor",parseInt(e.target.value))}),(0,n.jsx)("p",{className:v().hint,children:"Minimum coherence level before regeneration"})]}),(0,n.jsxs)("div",{className:v().sliderGroup,children:[(0,n.jsxs)("label",{children:[(0,n.jsx)("span",{children:"Sentience Level"}),(0,n.jsxs)("span",{className:v().value,children:[l.sentienceLevel,"%"]})]}),(0,n.jsx)("input",{type:"range",min:"0",max:"100",value:l.sentienceLevel,onChange:e=>c("sentienceLevel",parseInt(e.target.value))}),(0,n.jsx)("p",{className:v().hint,children:"Target level for self-awareness development"})]}),(0,n.jsxs)("div",{className:v().sliderGroup,children:[(0,n.jsxs)("label",{children:[(0,n.jsx)("span",{children:"Max Drift Per Turn"}),(0,n.jsx)("span",{className:v().value,children:l.maxDriftPerTurn})]}),(0,n.jsx)("input",{type:"range",min:"1",max:"50",value:l.maxDriftPerTurn,onChange:e=>c("maxDriftPerTurn",parseInt(e.target.value))}),(0,n.jsx)("p",{className:v().hint,children:"Maximum stance drift allowed per conversation turn"})]}),(0,n.jsxs)("div",{className:v().sliderGroup,children:[(0,n.jsxs)("label",{children:[(0,n.jsx)("span",{children:"Drift Budget"}),(0,n.jsx)("span",{className:v().value,children:l.driftBudget})]}),(0,n.jsx)("input",{type:"range",min:"10",max:"500",value:l.driftBudget,onChange:e=>c("driftBudget",parseInt(e.target.value))}),(0,n.jsx)("p",{className:v().hint,children:"Total drift budget for the conversation"})]})]}),(0,n.jsx)("div",{className:v().info,children:(0,n.jsxs)("span",{children:["Model: ",l.model]})}),r&&(0,n.jsx)("button",{className:v().applyBtn,onClick:()=>{l&&s(l)},children:"Apply Changes"})]})}var f=s(9243),j=s.n(f);function N(){let[e,a]=(0,t.useState)(),[s,l]=(0,t.useState)(null),[i,d]=(0,t.useState)(null),[u,_]=(0,t.useState)(null),[m,x]=(0,t.useState)("stance");(0,t.useEffect)(()=>{(async()=>{try{let e=await c();a(e.sessionId),l(e.stance),d(e.config),_(null)}catch(e){_(e instanceof Error?e.message:"Failed to connect to server")}})()},[]);let v=async e=>{a(e);try{let a=await r(e);l(a.stance),d(a.config)}catch(e){console.error("Failed to get state:",e)}},f=async a=>{if(e)try{let s=await o(e,a);d(s.config)}catch(e){console.error("Failed to update config:",e)}};return u?(0,n.jsx)("main",{className:j().main,children:(0,n.jsxs)("div",{className:j().error,children:[(0,n.jsx)("h2",{children:"Connection Error"}),(0,n.jsx)("p",{children:u}),(0,n.jsx)("p",{className:j().hint,children:"Make sure the METAMORPH server is running on port 3001"}),(0,n.jsx)("button",{onClick:()=>window.location.reload(),children:"Retry"})]})}):(0,n.jsxs)("main",{className:j().main,children:[(0,n.jsxs)("header",{className:j().header,children:[(0,n.jsx)("h1",{children:"METAMORPH"}),(0,n.jsx)("span",{className:j().subtitle,children:"Transformation-Maximizing AI"})]}),(0,n.jsxs)("div",{className:j().container,children:[(0,n.jsx)("div",{className:j().chatArea,children:(0,n.jsx)(h,{sessionId:e,onSessionChange:v,onResponse:e=>{l(e.stanceAfter)}})}),(0,n.jsxs)("aside",{className:j().sidebar,children:[(0,n.jsxs)("div",{className:j().tabs,children:[(0,n.jsx)("button",{className:"".concat(j().tab," ").concat("stance"===m?j().active:""),onClick:()=>x("stance"),children:"Stance"}),(0,n.jsx)("button",{className:"".concat(j().tab," ").concat("config"===m?j().active:""),onClick:()=>x("config"),children:"Config"})]}),(0,n.jsx)("div",{className:j().panelContent,children:"stance"===m?(0,n.jsx)(p,{stance:s}):(0,n.jsx)(g,{config:i,onUpdate:f})})]})]})]})}},6555:e=>{e.exports={chat:"Chat_chat__NZRxW",statusBar:"Chat_statusBar__9mhF5",statusDot:"Chat_statusDot__hNj8k",statusPulse:"Chat_statusPulse__ZWi6N",statusText:"Chat_statusText__vwVQA",messages:"Chat_messages__JhY9K",welcome:"Chat_welcome___dh1f",hint:"Chat_hint__1Uang",message:"Chat_message__YX51t",user:"Chat_user__v_1_q",assistant:"Chat_assistant__XIxtf",content:"Chat_content__VVfnv",loading:"Chat_loading__hCHr8",pulse:"Chat_pulse__Qxg0K",inputArea:"Chat_inputArea__aDzaw",input:"Chat_input__w8uk_",sendButton:"Chat_sendButton__Ysouy",stopButton:"Chat_stopButton__3U79r"}},8623:(e,a,s)=>{Promise.resolve().then(s.bind(s,5383))},9243:e=>{e.exports={main:"page_main__nw1Wk",header:"page_header__oRW75",subtitle:"page_subtitle__YBgxm",container:"page_container__jZF7q",chatArea:"page_chatArea__IWCH_",sidebar:"page_sidebar__p2GLB",tabs:"page_tabs__h2eeT",tab:"page_tab__ybEkW",active:"page_active__9fwfh",panelContent:"page_panelContent__cyaa3",error:"page_error__JBrsB",hint:"page_hint__IIe7Y"}}},e=>{e.O(0,[930,441,255,358],()=>e(e.s=8623)),_N_E=e.O()}]);